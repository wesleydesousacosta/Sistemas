# Sistemas

üü¶ logical_count.py
O script logical_count.py √© um cliente Python que se conecta ao servi√ßo etcd rodando no cont√™iner correspondente. Ele utiliza um mapeamento de nomes de n√≥s (NODE_NAME) para endere√ßos IP e, com base na vari√°vel de ambiente, determina para qual inst√¢ncia do etcd deve se conectar. O script tenta estabelecer a conex√£o na porta 2379, usada pelos clientes, e exibe uma mensagem de sucesso ou erro. Caso a conex√£o seja bem-sucedida, ele inicializa um rel√≥gio l√≥gico local com valor zero.
A fun√ß√£o update_lamport_clock √© o n√∫cleo do script. A cada dois segundos, ela incrementa o valor local do rel√≥gio, l√™ o valor atual salvo no etcd sob a chave /lamport_clock, calcula o novo valor com base na regra max(local, global) + 1, e atualiza esse valor no etcd junto com o identificador do processo e um timestamp real (para fins de observa√ß√£o). Isso simula o funcionamento de um rel√≥gio de Lamport distribu√≠do, permitindo que m√∫ltiplos cont√™ineres compartilhem e mantenham uma ordem l√≥gica dos eventos em sistemas distribu√≠dos.


üü© start_etcd.sh
O script start_etcd.sh √© respons√°vel por preparar e iniciar o ambiente do servi√ßo etcd dentro de um cont√™iner Linux. Ele come√ßa atualizando os pacotes do sistema e instalando ferramentas necess√°rias como wget, curl e net-tools. Em seguida, ele baixa a vers√£o 3.5.6 do etcd diretamente do reposit√≥rio oficial do GitHub, descompacta o arquivo e move os bin√°rios para o diret√≥rio /usr/local/bin, tornando-os execut√°veis no sistema. Ap√≥s isso, cria-se o diret√≥rio /var/lib/etcd para armazenar os dados do servi√ßo.
Com a instala√ß√£o conclu√≠da, o script determina o endere√ßo IP local com base na vari√°vel de ambiente NODE_NAME, que identifica o nome do n√≥ atual. Dependendo do nome, ele associa o IP correspondente e inicializa o etcd com os par√¢metros necess√°rios para formar um cluster com tr√™s n√≥s (mx-nodel, mx-nodel2 e mx-nodel3). Cada inst√¢ncia √© configurada para escutar conex√µes dos peers na porta 2380 e de clientes na porta 2379, permitindo a comunica√ß√£o entre os n√≥s e a sincroniza√ß√£o de dados de forma distribu√≠da.
